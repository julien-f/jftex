%%
% This program is free software: you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or
% (at your option) any later version.
%
% This program is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with this program.  If not, see <http://www.gnu.org/licenses/>.
%
% Author:
%   Julien Fontanet <julien.fontanet@isonoe.net>
%
% v0.3.1 - 2011-01-07
% - “png”, “jpg” and “jpeg” added to the default images extension list.
% - The “\newmathcommand” macro simplify the definition of math-oriented
%   commands.
% v0.3 - 2011-01-04
% - The parskip package can be skipped by using the “parskip=false” option.
% - New command “\email” to display clickable email addresses.
% v0.2.1 - 2011-01-02
% - The default language is now English instead of French.
% v0.2 - 2011-01-02
% - The document's language can be specified with the “lang” option.
% - The “\maketitle” command is now compatible with languages other than French.
% - jftex now uses the “kvoptions” package to parse its options.
%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{jftex}[2011/01/07 v0.3.1 jftex]

%%%%%

\RequirePackage{ifxetex}

%%%%%

\RequirePackage{kvoptions}

\SetupKeyvalOptions{
  family=@jftex,
  prefix=@jftex@
}

% This option override the xelatex detection.
\ifxetex
  \DeclareBoolOption[true]{xelatex}
\else
  \DeclareBoolOption{xelatex}
\fi

\DeclareComplementaryOption{pdflatex}{xelatex}

% Should the listings package be included?
\DeclareBoolOption[false]{listings}

% Should the minted package be included?
\DeclareBoolOption[false]{minted}

% Should the parskip package be included?
\DeclareBoolOption[true]{parskip}

% What is the language(s) of this document?
\DeclareStringOption[english]{lang}

\ProcessKeyvalOptions*

%%%%%

\if@jftex@xelatex % xelatex
  \RequirePackage{fontspec}
  \RequirePackage{xunicode}
  \RequirePackage{xltxtra} % Various fixes.
\else % pdflatex
  \RequirePackage[utf8]{inputenc}   % Uses UTF8 as input encoding.
  \RequirePackage{amsfonts,amsmath} % Mathematical fonts and symbols.
\fi

\RequirePackage[\@jftex@lang]{babel}          % Sets the document language.
\RequirePackage[a4paper,margin=2cm]{geometry} % Sets the geometry.

\RequirePackage{graphicx}             % Pour insérer des graphiques.
\RequirePackage{subfig}               % Fourni un support pour l'inclusion de
                                      % petites figures ou tableaux
\RequirePackage{url}                  % Pour gérer correctement les césures des URL.
\RequirePackage{hyperref}             % Pour que les références soient des liens.
\RequirePackage{xspace}
%\RequirePackage{latexsym}             % Paquetage de symboles standard de LaTeX.

\if@jftex@parskip
  \RequirePackage{parskip}
\fi

\if@jftex@listings
  \RequirePackage{listings}
  \RequirePackage{xcolor}
\fi

\if@jftex@minted
  \RequirePackage{minted}
\fi

%%%%%

\if@jftex@listings
  \definecolor{Aluminium}{rgb}{0.95,0.95,0.94}

  \lstset{
    % Type du cadre (“none”, “leftline”, “topline”, “bottomline”, “lines”,
    % “single” or “shadowbox”).
    frame=single,
    %
    % Pour chaque coin du cadre (haut-droit, bas-droit, bas-gauche et haut-gauche)
    % définie si il est arrondi (“t”) ou non (“f”) (défaut “ffff”).
    frameround=tttt,
    %
    % Couleur du fond.
    backgroundcolor=\color{Aluminium},
    %
    % Style de base du texte (défaut “{}”).
    basicstyle=\small\ttfamily,
    %
    % Listings doit-il couper les lignes trop longues ? (défaut “false”).
    breaklines=true,
    %
    % Style pour les commentaires.
    commentstyle=\rmfamily\color[rgb]{0.3,0.3,0.3}\itshape,
    %
    % Définie des styles supplémentaires pour certains mots.
    %emph=[1]{},       % Définir les mots.
    %moreemph=[1]{},   % Ajouter des mots.
    %deleteemph=[1]{}, % Supprimer des mots.
    %emphstyle=[1]{},  % Définir le style pour ces mots.
    %
    % Définie le style pour les mots clefs.
    keywordstyle=\color{blue},
    %
    % Définie le langage par défaut utilisé pour la coloration syntaxique
    % (defaut “{}”).
    %language=,
    %
    % Hauteur de l'espace inséré entre chaque ligne (défaut 0pt).
    %lineskip=1pt,
    %
    % Affichage des numéros de ligne (“none” par défaut, “left” ou “right”).
    numbers=left,
    %
    % Distance entre les numéros de ligne et le code (défaut “10pt”).
    numbersep=5pt,
    %
    % Style des numéros de ligne.
    numberstyle=\tt\small\color{gray},
    %
    % Nombre d'espace représentant une tabulation (défaut “8”).
    tabsize=4,
    %
    % Les commentaires doivent-ils être interprétés comme du LaTeX
    % (defaut “false”) ?
    %texcl=true,
  }
\fi

%%%%%

% Où les images sont-elles rangées ?
\graphicspath{
  {images/}
}

% Extensions par défaut des images.
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.jpeg}

%%%%%

% Command for displaying properly email addresses.
\newcommand{\email}[1]{%
  \href{mailto:#1}{\nolinkurl{#1}}%
}

% Command for creating text macros.
\newcommand{\newtextcommand}[2]{%
  \providecommand{#1}{#2\xspace}%
}

% Command for displaying proper-nouns.
\newcommand{\printpropernoun}[1]{%
  \emph{#1}%
}
% Command for displaying Latin locutions.
\newcommand{\printlatinloc}[1]{%
  \textit{#1}%
}

% Command for creating proper-noun marcros.
\newcommand{\newpropernoun}[2]{%
  \newtextcommand{#1}{\printpropernoun{#2}}%
}

% Command for creating Latin locutions.
\newcommand{\newlatinloc}[2]{%
  \newtextcommand{#1}{\printlatinloc{#2}}%
}

\newtextcommand{\cad}{c'est-à-dire}
\newtextcommand{\Cad}{C'est-à-dire}

\newlatinloc{\apriori}{a priori}
\newlatinloc{\Apriori}{A priori}
\newlatinloc{\aposteriori}{a posteriori}
\newlatinloc{\Aposteriori}{A posteriori}

%%%%%

\newcommand{\newmathcommand}[1]{%
  \ensuremath{#1}%
}
